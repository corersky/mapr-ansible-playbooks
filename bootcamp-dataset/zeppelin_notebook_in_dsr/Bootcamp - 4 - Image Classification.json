{"paragraphs":[{"title":"Lesson 8","text":"In this lesson you will be querying the MapR-DB replicated table using Apache Drill in this Apache Zeppelin notebook.\n\nThe notebook consists out of a number of queries that reflect business questions about the classified image. The initial query constructs a Apache Drill view that is referenced in later parts of this notebook so therefore, it is important to perform that query first before continuing with the other queries.","user":"mapr","dateUpdated":"2018-01-17T09:57:45+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965674_-209042547","id":"20180111-080459_1654389256","dateCreated":"2018-01-17T09:56:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8341"},{"title":"Prerequisite","text":"%drill\nALTER SYSTEM SET `planner.enable_decimal_data_type` = true;","user":"mapr","dateUpdated":"2018-01-17T15:05:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516200740910_-889566391","id":"20180117-145220_379170761","dateCreated":"2018-01-17T14:52:20+0000","dateStarted":"2018-01-17T14:52:46+0000","dateFinished":"2018-01-17T14:52:46+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8342"},{"title":"Create a View for querying the classified data","text":"%drill\nCreate or Replace View \n    dfs.root.`/remote-image-classification/remote-image-output-table_view` as select\n    Image\n    , Cast(`Year` as Decimal(4,0)) as `Year`\n    , Cast(`Month` as Decimal(2,0)) as `Month`\n    , Cast(`Day` as Decimal(2,0)) as `Day`\n    , Cast(`HourMinute` as Decimal(4,0)) as `HourMinute`\n    , Cast(`Hour` as Decimal(2,0)) as `Hour`\n    , Cast(`Minute` as Decimal(2,0)) as `Minute`\n    , Cast(`Time` as Decimal(6,0)) as `Time`\n    , Label\n    , Confidence\n    , TopLeftX\n    , TopLeftY\n    , BottomRightX\n    , BottomRightY\n    from\n        (select \n        t.Image as Image\n        , SUBSTR(t.Image, 8, 4) `Year`\n        , SUBSTR(t.Image, 12, 2) `Month`\n        , SUBSTR(t.Image, 14, 2) `Day`\n        , SUBSTR(t.Image, 17, 4) `HourMinute`\n        , SUBSTR(t.Image, 17, 2) `Hour`\n        , SUBSTR(t.Image, 19, 2) `Minute`\n        , SUBSTR(t.Image, 17, 6) `Time`\n        , t.objects.label Label\n        , t.objects.confidence Confidence\n        , t.objects.topleft.x TopLeftX\n        , t.objects.topleft.y TopLeftY\n        , t.objects.bottomright.x BottomRightX\n        , t.objects.bottomright.y BottomRightY \n    from (select _Id as Image, flatten(objects) as objects from dfs.root.`/remote-image-classification/remote-image-output-table`) t)\n","user":"mapr","dateUpdated":"2018-01-17T14:52:01+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965677_-211735790","id":"20180111-085519_134746019","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:52:01+0000","dateFinished":"2018-01-17T14:52:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8343"},{"title":"Count the total number of objects in the dataset.","text":"%drill\nselect count(Distinct Image) as `Files`, count(*) as Objects from dfs.root.`/remote-image-classification/remote-image-output-table_view`","user":"mapr","dateUpdated":"2018-01-17T14:52:58+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965678_-210581543","id":"20180111-081054_1882856626","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:52:58+0000","dateFinished":"2018-01-17T14:52:59+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8344"},{"text":"%drill\nselect *  from dfs.root.`/remote-image-classification/remote-image-output-table_view` limit 10","user":"mapr","dateUpdated":"2018-01-17T14:44:21+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965678_-210581543","id":"20180111-123744_907442680","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:44:21+0000","dateFinished":"2018-01-17T14:44:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8345"},{"title":"Which are the Top 5 objects that have been classified?","text":"%drill\nselect Label, count(*) Number from dfs.root.`/remote-image-classification/remote-image-output-table_view` group by Label order by 2 desc LIMIT 5\n","user":"mapr","dateUpdated":"2018-01-17T14:44:54+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965679_-210966292","id":"20180111-081210_1820375252","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:44:54+0000","dateFinished":"2018-01-17T14:44:55+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8346"},{"title":"What are the Top 3 images with the most objects classified","text":"%drill\nselect  Image, count(*) Number from dfs.root.`/remote-image-classification/remote-image-output-table_view` group by Image order by 2 desc LIMIT 3","user":"mapr","dateUpdated":"2018-01-17T14:45:27+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965679_-210966292","id":"20180111-093758_1983859732","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:45:27+0000","dateFinished":"2018-01-17T14:45:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8347"},{"title":"What are the Top 10 images with the most objects classified","text":"%drill\nselect  Image, count(*) Number from dfs.root.`/remote-image-classification/remote-image-output-table_view` group by Image order by 2 desc Limit 10 ","user":"mapr","dateUpdated":"2018-01-17T14:45:38+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true},"stackedAreaChart":{}},"commonSetting":{},"keys":[{"name":"Filename","index":1,"aggr":"sum"},{"name":"Label","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Number","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965680_-200578072","id":"20180111-102932_1663055320","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:45:38+0000","dateFinished":"2018-01-17T14:45:38+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8348"},{"title":"What are the Labels for the Top 5 images with the most objects classified?","text":"%drill\nselect Label, sum(`Number`) as `Number` from\n(select Image, Label, count(Label) as `Number` from  dfs.root.`/remote-image-classification/remote-image-output-table_view` \nwhere Image in \n(select Image from  \n(select Image, count(*) from dfs.root.`/remote-image-classification/remote-image-output-table_view` \nGroup by Image Order By 2 Desc limit 5) vb\n) group by Image, Label )\nGroup by Label Order By `Number` Desc","user":"mapr","dateUpdated":"2018-01-17T14:47:00+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965681_-200962820","id":"20180111-201010_171634294","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:47:00+0000","dateFinished":"2018-01-17T14:47:00+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8349"},{"title":"What are the Labels for the Top 5 images with the most objects classified per image?","text":"%drill\nselect Image, Label, count(Label) as `Number` from  dfs.root.`/remote-image-classification/remote-image-output-table_view` \nwhere Image in \n(select Image from  \n(select Image, count(*) from dfs.root.`/remote-image-classification/remote-image-output-table_view` \nGroup by Image Order By 2 Desc limit 5) vb\n) group by Image, Label Order By 2 Desc","user":"mapr","dateUpdated":"2018-01-17T14:47:51+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true}},"commonSetting":{},"keys":[{"name":"Image","index":0,"aggr":"sum"}],"groups":[{"name":"Label","index":1,"aggr":"sum"}],"values":[{"name":"Number","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965681_-200962820","id":"20180112-073301_1977755800","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:47:37+0000","dateFinished":"2018-01-17T14:47:38+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8350"},{"title":"What is the image with the least classified objects and at what time was it taken?","text":"%drill\nselect Image,`Time`, Label, count(Label) as `Number` from  dfs.root.`/remote-image-classification/remote-image-output-table_view` \nwhere Image in (select Image from \n(select Image, count(*) Number from dfs.root.`/remote-image-classification/remote-image-output-table_view` group by Image order by 2 asc LIMIT 1))\nGroup By Image, `Time`, Label Order By 4 Desc\n","user":"mapr","dateUpdated":"2018-01-17T14:48:49+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965682_-199808574","id":"20180111-090834_419928583","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:48:49+0000","dateFinished":"2018-01-17T14:48:50+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8351"},{"title":"What is  the spread over time of the number of images classified?","text":"%drill\nselect Image, Label, `Hour` as Uur, count(Label) Number from dfs.root.`/remote-image-classification/remote-image-output-table_view`  group by Image, `Hour`, Label order by 3 Asc\n","user":"mapr","dateUpdated":"2018-01-17T14:49:09+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"Uur","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"Number","index":3,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965682_-199808574","id":"20180112-073325_1781275764","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:49:09+0000","dateFinished":"2018-01-17T14:49:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8352"},{"title":"Show graphically when we went for lunch","text":"%drill\nselect Image, Label, `Hour` as Uur, count(Label) as `Number`  from dfs.root.`/remote-image-classification/remote-image-output-table_view` Where Label = 'person'  group by Image, `Hour`, Label order by 3 Asc\n\n\n","user":"mapr","dateUpdated":"2018-01-17T14:49:41+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"Uur","index":2,"aggr":"sum"}],"groups":[{"name":"Label","index":1,"aggr":"sum"}],"values":[{"name":"Number","index":3,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965682_-199808574","id":"20180112-101956_1464230900","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:49:41+0000","dateFinished":"2018-01-17T14:49:42+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8353"},{"title":"Show the presence of identified persons in the room","text":"%drill\nselect Image, Label, HourMinute, count(Label) as `Number`  from dfs.root.`/remote-image-classification/remote-image-output-table_view` Where Label = 'person'  group by Image, HourMinute, Label order by 2 Asc\n\n\n","user":"mapr","dateUpdated":"2018-01-17T15:01:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"HourMinute","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"Number","index":3,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516182965683_-200193323","id":"20180112-104902_1789045613","dateCreated":"2018-01-17T09:56:05+0000","dateStarted":"2018-01-17T14:55:34+0000","dateFinished":"2018-01-17T14:55:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8354"},{"text":"%drill\n","user":"mapr","dateUpdated":"2018-01-17T15:02:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1516201332216_-843014540","id":"20180117-150212_1054404902","dateCreated":"2018-01-17T15:02:12+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8355"}],"name":"ImageClassification","id":"2D5A8V5GJ","angularObjects":{"2CWXN6156:shared_process":[],"2CZWGKVGC:shared_process":[],"2CZF1R6YF:shared_process":[],"2CYU3RYTQ:shared_process":[],"2CWYA8QH7:shared_process":[],"2CZVX7F7C:shared_process":[],"2CXVCPB7H:shared_process":[],"2CXT2M2HN:shared_process":[],"2CWUS6MTD:shared_process":[],"2CZQ6X16B:shared_process":[],"2D14PXUN7:shared_process":[],"2CZCT9G1W:shared_process":[],"2CX9QKGPF:shared_process":[],"2CYNJWSQ7:shared_process":[],"2CYSWPC59:shared_process":[],"2CZFS9WUF:shared_process":[],"2CY7FTAYC:shared_process":[],"2CYTFKYER:shared_process":[],"2CY5H7VTU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}